<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   Xilinx Driver canps v2_1: xcanps_selftest.c File Reference
</title>
<link href="doxygen_kalyanidocs/doc/css/driver_api_doxygen.css" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">

<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>xcanps_selftest.c File Reference</h1><code>#include &quot;xstatus.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="xcanps_8h.html">xcanps.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xcanps__selftest_8c.html#acfcfafaf3ae82d8c89c3b5b687b4b65e">XCANPS_MAX_FRAME_SIZE_IN_WORDS</a>&nbsp;&nbsp;&nbsp;(XCANPS_MAX_FRAME_SIZE / sizeof(u32))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xcanps__selftest_8c.html#a3317b62fb7f445865d6d8288847a6dac">FRAME_DATA_LENGTH</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xcanps__selftest_8c.html#a7b41aa40bddd212d039bd7e5171f0cf3">XCanPs_SelfTest</a> (<a class="el" href="struct_x_can_ps.html">XCanPs</a> *InstancePtr)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This file contains a diagnostic self-test function for the <a class="el" href="struct_x_can_ps.html">XCanPs</a> driver.</p>
<p>Read <a class="el" href="xcanps_8h.html">xcanps.h</a> file for more information.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The Baud Rate Prescaler Register (BRPR) and Bit Timing Register(BTR) are setup such that CAN baud rate equals 40Kbps, given the CAN clock equal to 24MHz. These need to be changed based on the desired baudrate and CAN clock frequency.</dd></dl>
<pre>
 MODIFICATION HISTORY:</pre><pre> Ver   Who    Date	Changes
 ----- -----  -------- -----------------------------------------------
 1.00a xd/sv  01/12/10 First release
 </pre> <hr/><h2>Define Documentation</h2>
<a class="anchor" id="a3317b62fb7f445865d6d8288847a6dac"></a><!-- doxytag: member="xcanps_selftest.c::FRAME_DATA_LENGTH" ref="a3317b62fb7f445865d6d8288847a6dac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FRAME_DATA_LENGTH&nbsp;&nbsp;&nbsp;8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="acfcfafaf3ae82d8c89c3b5b687b4b65e"></a><!-- doxytag: member="xcanps_selftest.c::XCANPS_MAX_FRAME_SIZE_IN_WORDS" ref="acfcfafaf3ae82d8c89c3b5b687b4b65e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XCANPS_MAX_FRAME_SIZE_IN_WORDS&nbsp;&nbsp;&nbsp;(XCANPS_MAX_FRAME_SIZE / sizeof(u32))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7b41aa40bddd212d039bd7e5171f0cf3"></a><!-- doxytag: member="xcanps_selftest.c::XCanPs_SelfTest" ref="a7b41aa40bddd212d039bd7e5171f0cf3" args="(XCanPs *InstancePtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XCanPs_SelfTest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_can_ps.html">XCanPs</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function runs a self-test on the CAN driver/device. The test resets the device, sets up the Loop Back mode, sends a standard frame, receives the frame, verifies the contents, and resets the device again.</p>
<p>Note that this is a destructive test in that resets of the device are performed. Refer the device specification for the device status after the reset operation.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_can_ps.html">XCanPs</a> instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if the self-test passed. i.e., the frame received via the internal loop back has the same contents as the frame sent.</li>
<li>XST_FAILURE Otherwise.</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd></dd></dl>
<p>If the CAN device does not work properly, this function may enter an infinite loop and will never return to the caller. <br/>
<br/>
 If XST_FAILURE is returned, the device is not reset so that the caller could have a chance to check reason(s) causing the failure. </p>

</div>
</div>
</div>
<p class="Copyright">
Copyright &copy; 1995-2014 Xilinx, Inc. All rights reserved.
</p>
</body>
</html>
