<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   Xilinx Driver dma v8_0: xaxidma_bd.c File Reference
</title>
<link href="doxygen_kalyanidocs/doc/css/driver_api_doxygen.css" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">

<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>xaxidma_bd.c File Reference</h1><code>#include &quot;<a class="el" href="xaxidma__bd_8h.html">xaxidma_bd.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#a4056035d8e7c90a68fa954c60d021e07">XAxiDma_BdSetLength</a> (<a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *BdPtr, u32 LenBytes, u32 LengthMask)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#a3fe71aa7471b7726182cbc8d377da5f3">XAxiDma_BdSetBufAddr</a> (<a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *BdPtr, u32 Addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#a0a69ac6c2688e000ced43991bfcbfe57">XAxiDma_BdSetBufAddrMicroMode</a> (<a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *BdPtr, u32 Addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#afc6434a23594c20c2b601f010a979e48">XAxiDma_BdSetAppWord</a> (<a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *BdPtr, int Offset, u32 Word)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#a9d2814e4249884e68fe9e6f370920ca4">XAxiDma_BdGetAppWord</a> (<a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *BdPtr, int Offset, int *Valid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#a4eb2615ac89054e982c3f3c37f0ddb52">XAxiDma_BdSetCtrl</a> (<a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *BdPtr, u32 Data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxidma__bd_8c.html#a53983f629aba5b4ebf27f803a7a9284e">XAxiDma_DumpBd</a> (<a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *BdPtr)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Buffer descriptor (BD) management API implementation.</p>
<pre>
 MODIFICATION HISTORY:</pre><pre> Ver   Who  Date     Changes
 ----- ---- -------- -------------------------------------------------------
 1.00a jz   05/18/10 First release
 2.00a jz   08/10/10 Second release, added in <a class="el" href="xaxidma__g_8c.html">xaxidma_g.c</a>, <a class="el" href="xaxidma__sinit_8c.html">xaxidma_sinit.c</a>,
                     updated tcl file, added <a class="el" href="xaxidma__porting__guide_8h.html">xaxidma_porting_guide.h</a>
 3.00a jz   11/22/10 Support IP core parameters change
 6.00a srt  01/24/12 Added support for Multi-Channel DMA.</p>
<ul>
<li>Changed APIs
			* XAxiDma_BdSetLength(XAxiDma_Bd *BdPtr,
					u32 LenBytes, u32 LengthMask)
		* <a class="el" href="xaxidma__bd_8h.html#aae88a4ef129d6100fd087f7693186d80">XAxiDma_BdGetActualLength(BdPtr, LengthMask)</a>
			* <a class="el" href="xaxidma__bd_8h.html#adaf226acada2c1d857d29205ce4c2a58">XAxiDma_BdGetLength(BdPtr, LengthMask)</a>
 8.0   srt  01/29/14 Added support for Micro DMA Mode:</li>
<li>New API
			 <a class="el" href="xaxidma__bd_8h.html#a0a69ac6c2688e000ced43991bfcbfe57">XAxiDma_BdSetBufAddrMicroMode(XAxiDma_Bd*, u32)</a></li>
</ul>
</pre><pre> </pre> <hr/><h2>Function Documentation</h2>
<a class="anchor" id="a9d2814e4249884e68fe9e6f370920ca4"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdGetAppWord" ref="a9d2814e4249884e68fe9e6f370920ca4" args="(XAxiDma_Bd *BdPtr, int Offset, int *Valid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32 XAxiDma_BdGetAppWord </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>Valid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the APP word at the specified APP word offset for a BD.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Offset</em>&nbsp;</td><td>is the offset inside the APP word, it is valid from 0 to 4 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Valid</em>&nbsp;</td><td>is to tell the caller whether parameters are valid</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The APP word. Passed in parameter Valid holds 0 for failure, and 1 for success.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>

</div>
</div>
<a class="anchor" id="afc6434a23594c20c2b601f010a979e48"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetAppWord" ref="afc6434a23594c20c2b601f010a979e48" args="(XAxiDma_Bd *BdPtr, int Offset, u32 Word)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiDma_BdSetAppWord </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>Word</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the APP word at the specified APP word offset for a BD.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Offset</em>&nbsp;</td><td>is the offset inside the APP word, it is valid from 0 to 4 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Word</em>&nbsp;</td><td>is the value to set</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li>
<li>XST_INVALID_PARAM under following error conditions: 1) StsCntrlStrm is not built in hardware 2) Offset is not in valid range</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>If the hardware build has C_SG_USE_STSAPP_LENGTH set to 1, then the last APP word, XAXIDMA_LAST_APPWORD, must have non-zero value when AND with 0x7FFFFF. Not doing so will cause the hardware to stall. This function can be used only when DMA is in SG mode </dd></dl>

</div>
</div>
<a class="anchor" id="a3fe71aa7471b7726182cbc8d377da5f3"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetBufAddr" ref="a3fe71aa7471b7726182cbc8d377da5f3" args="(XAxiDma_Bd *BdPtr, u32 Addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiDma_BdSetBufAddr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>Addr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the BD's buffer address.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Addr</em>&nbsp;</td><td>is the address to set</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if buffer address set successfully</li>
<li>XST_INVALID_PARAM if hardware has no DRE and address is not aligned</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>

</div>
</div>
<a class="anchor" id="a0a69ac6c2688e000ced43991bfcbfe57"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetBufAddrMicroMode" ref="a0a69ac6c2688e000ced43991bfcbfe57" args="(XAxiDma_Bd *BdPtr, u32 Addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiDma_BdSetBufAddrMicroMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>Addr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the BD's buffer address when configured for Micro Mode. The buffer address should be 4K aligned.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Addr</em>&nbsp;</td><td>is the address to set</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if buffer address set successfully</li>
<li>XST_INVALID_PARAM if hardware has no DRE and address is not aligned</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>

</div>
</div>
<a class="anchor" id="a4eb2615ac89054e982c3f3c37f0ddb52"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetCtrl" ref="a4eb2615ac89054e982c3f3c37f0ddb52" args="(XAxiDma_Bd *BdPtr, u32 Data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XAxiDma_BdSetCtrl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>Data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the control bits for a BD.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Data</em>&nbsp;</td><td>is the bit value to set</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>

</div>
</div>
<a class="anchor" id="a4056035d8e7c90a68fa954c60d021e07"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_BdSetLength" ref="a4056035d8e7c90a68fa954c60d021e07" args="(XAxiDma_Bd *BdPtr, u32 LenBytes, u32 LengthMask)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiDma_BdSetLength </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>LenBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>LengthMask</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the length field for the given BD.</p>
<p>Length has to be non-zero and less than LengthMask.</p>
<p>For TX channels, the value passed in should be the number of bytes to transmit from the TX buffer associated with the given BD.</p>
<p>For RX channels, the value passed in should be the size of the RX buffer associated with the given BD in bytes. This is to notify the RX channel the capability of the RX buffer to avoid buffer overflow.</p>
<p>The actual receive length can be equal or smaller than the specified length. The actual transfer length will be updated by the hardware in the XAXIDMA_BD_STS_OFFSET word in the BD.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LenBytes</em>&nbsp;</td><td>is the requested transfer length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LengthMask</em>&nbsp;</td><td>is the maximum transfer length</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li>
<li>XST_INVALID_PARAM for invalid BD length</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>

</div>
</div>
<a class="anchor" id="a53983f629aba5b4ebf27f803a7a9284e"></a><!-- doxytag: member="xaxidma_bd.c::XAxiDma_DumpBd" ref="a53983f629aba5b4ebf27f803a7a9284e" args="(XAxiDma_Bd *BdPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XAxiDma_DumpBd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="xaxidma__bd_8h.html#a5faf4d844b10fc577f3a75a170f11867">XAxiDma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dump the fields of a BD.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the BD to operate on.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function can be used only when DMA is in SG mode </dd></dl>

</div>
</div>
</div>
<p class="Copyright">
Copyright &copy; 1995-2014 Xilinx, Inc. All rights reserved.
</p>
</body>
</html>
