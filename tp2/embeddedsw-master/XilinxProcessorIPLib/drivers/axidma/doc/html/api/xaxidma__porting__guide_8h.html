<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   Xilinx Driver dma v8_0: xaxidma_porting_guide.h File Reference
</title>
<link href="doxygen_kalyanidocs/doc/css/driver_api_doxygen.css" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">

<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>xaxidma_porting_guide.h File Reference</h1><table border="0" cellpadding="0" cellspacing="0">
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This is a guide on how to move from using the xlldma driver to use xaxidma driver.</p>
<pre>
 MODIFICATION HISTORY:</pre><pre> Ver   Who  Date     Changes
 ----- ---- -------- -------------------------------------------------------
 1.00a jz   05/18/10 First release
 2.00a jz   08/10/10 Second release, added in <a class="el" href="xaxidma__g_8c.html">xaxidma_g.c</a>, <a class="el" href="xaxidma__sinit_8c.html">xaxidma_sinit.c</a>,
                     updated tcl file, added <a class="el" href="xaxidma__porting__guide_8h.html">xaxidma_porting_guide.h</a>
 4.00a rkv  02/22/11 Added support for simple DMA mode
 6.00a srt  03/27/12 Added support for MCDMA mode
 7.00a srt  06/18/12 API calls are reverted back for backward compatibility.</pre><pre> </pre><p><b>Overview</b></p>
<p>The API for xaxidma driver is similar to xlldma driver. The prefix for the API functions and structures is XAxiDma_ for the xaxidma driver.</p>
<p>Due to hardware feature changes, signatures of some API functions are a little bit different from the xlldma API functions.</p>
<p>We present API functions:</p>
<ul>
<li>That only have prefix changes</li>
<li>That have different return type</li>
<li>That are new API functions</li>
<li>That have been removed</li>
</ul>
<p>Note that data structures have different prefix of XAxiDma_. Those API functions, that have data structures with prefix change, are considered as prefix change.</p>
<p><b>API Functions That Only Have Prefix Changes</b></p>
<pre>
         xlldma driver              |         xaxidma driver (upto v5_00_a)
 -----------------------------------------------------------------------
    XLlDma_Reset(...)               |  XAxiDma_Reset(...)
    XLlDma_BdRingSnapShotCurrBd(...)|  XAxiDma_BdRingSnapShotCurrBd(...)
    XLlDma_BdRingNext(...)          |  XAxiDma_BdRingNext(...)
    XLlDma_BdRingPrev(...)          |  XAxiDma_BdRingPrev(...)
    XLlDma_BdRingGetSr(...)         |  XAxiDma_BdRingGetSr(...)
    XLlDma_BdRingBusy(...)          |  XAxiDma_BdRingBusy(...)
    XLlDma_BdRingIntEnable(...)     |  XAxiDma_BdRingIntEnable(...)
    XLlDma_BdRingIntDisable(...)    |  XAxiDma_BdRingIntDisable(...)
    XLlDma_BdRingIntGetEnabled(...) |  XAxiDma_BdRingIntGetEnabled(...)
    XLlDma_BdRingGetIrq(...)        |  XAxiDma_BdRingGetIrq(...)
    XLlDma_BdRingAckIrq(...)        |  XAxiDma_BdRingAckIrq(...)
    XLlDma_BdRingCreate(...)        |  XAxiDma_BdRingCreate(...)
    XLlDma_BdRingClone(...)         |  XAxiDma_BdRingClone(...)
    XLlDma_BdRingAlloc(...)         |  XAxiDma_BdRingAlloc(...)
    XLlDma_BdRingUnAlloc(...)       |  XAxiDma_BdRingUnAlloc(...)
    XLlDma_BdRingToHw(...)          |  XAxiDma_BdRingToHw(...)
    XLlDma_BdRingFromHw(...)        |  XAxiDma_BdRingFromHw(...)
    XLlDma_BdRingFree(...)          |  XAxiDma_BdRingFree(...)
    XLlDma_BdRingStart(...)         |  XAxiDma_BdRingStart(...)
    XLlDma_BdRingCheck(...)         |  XAxiDma_BdRingCheck(...)
    XLlDma_BdRingSetCoalesce(...)   |  XAxiDma_BdRingSetCoalesce(...)
    XLlDma_BdRingGetCoalesce(...)   |  XAxiDma_BdRingGetCoalesce(...)
    XLlDma_BdRead(...)              |  XAxiDma_BdRead(...)
    XLlDma_BdWrite(...)             |  XAxiDma_BdWrite(...)
    XLlDma_BdClear(...)             |  XAxiDma_BdClear(...)
    XLlDma_BdSetId(...)             |  XAxiDma_BdSetId(...)
    XLlDma_BdGetId(...)             |  XAxiDma_BdGetId(...)
    XLlDma_BdGetLength(...)         |  XAxiDma_BdGetLength(...)
    XLlDma_BdGetBufAddr(...)        |  XAxiDma_BdGetBufAddr(...)</pre><pre></pre><p><b>API Functions That Have Different Return Type</b></p>
<p>Due to possible hardware failures, The caller should check the return value of the following functions.</p>
<pre>
         xlldma driver              |         xaxidma driver
 -----------------------------------------------------------------------
 void XLlDma_Pause(...)             | int XAxiDma_Pause(...)
 void XLlDma_Resume(...)            | int XAxiDma_Resume(...)
 </pre><p>The following functions have return type changed:</p>
<pre>
         xlldma driver              |         xaxidma driver
 -----------------------------------------------------------------------
 XLlDma_BdRing XLlDma_GetRxRing(...)| <a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * XAxiDma_GetRxRing(...)
 XLlDma_BdRing XLlDma_GetTxRing(...)| <a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * XAxiDma_GetTxRing(...)
 u32 XLlDma_BdRingMemCalc(...)      | int XAxiDma_BdRingMemCalc(...)
 u32 XLlDma_BdRingCntCalc(...)      | int XAxiDma_BdRingCntCalc(...)
 u32 XLlDma_BdRingGetCnt(...)       | int XAxiDma_BdRingGetCnt(...)
 u32 XLlDma_BdRingGetFreeCnt(...)   | int XAxiDma_BdRingGetFreeCnt(...)
 void XLlDma_BdSetLength(...)       | int XAxiDma_BdSetLength(...)
 void XLlDma_BdSetBufAddr(...)      | int XAxiDma_BdSetBufAddr(...)
</pre><p><b>API Functions That Are New API Functions</b></p>
<p>Now that the AXI DMA core is a standalone core, some new API are intrduced. Some other functions are added due to hardware interface change, so to replace old API functions.</p>
<ul>
<li><a class="el" href="struct_x_axi_dma___config.html">XAxiDma_Config</a> *XAxiDma_LookupConfig(u32 DeviceId);</li>
<li>int <a class="el" href="xaxidma_8h.html#a8026e76c90d891d21c9c355ff776cb77">XAxiDma_CfgInitialize(XAxiDma * InstancePtr, XAxiDma_Config *Config)</a>;</li>
<li>int <a class="el" href="xaxidma_8h.html#af73e1329e40c8ac1ae47a7d9c104af75">XAxiDma_ResetIsDone(XAxiDma * InstancePtr)</a>;</li>
<li>XAxiDma_Bd * <a class="el" href="xaxidma__bdring_8h.html#add32e45591597a4bfa84b66dffc98913">XAxiDma_BdRingGetCurrBd(XAxiDma_BdRing* RingPtr)</a>;</li>
<li>int <a class="el" href="xaxidma__bdring_8h.html#a766bed2454969636d827fb79faeeee97">XAxiDma_BdRingHwIsStarted(XAxiDma_BdRing* RingPtr)</a>;</li>
<li>void <a class="el" href="xaxidma__bdring_8h.html#affa661a9a2467c1e274842c147531cea">XAxiDma_BdRingDumpRegs(XAxiDma_BdRing *RingPtr)</a>;</li>
<li>int <a class="el" href="xaxidma__bdring_8h.html#a7b38bc9220c391823219937580bd816f">XAxiDma_StartBdRingHw(XAxiDma_BdRing* RingPtr)</a>;</li>
<li>void <a class="el" href="xaxidma__bd_8h.html#a4eb2615ac89054e982c3f3c37f0ddb52">XAxiDma_BdSetCtrl(XAxiDma_Bd *BdPtr, u32 Data)</a>;</li>
<li>u32 <a class="el" href="xaxidma__bd_8h.html#a495e780d704ecf548d3536b3bb8961a5">XAxiDma_BdGetCtrl(XAxiDma_Bd* BdPtr)</a>;</li>
<li>u32 <a class="el" href="xaxidma__bd_8h.html#a8a0271e5255b139cc63e08e46b9c473a">XAxiDma_BdGetSts(XAxiDma_Bd* BdPtr)</a>;</li>
<li>int <a class="el" href="xaxidma__bd_8h.html#a844fc6b60315598387d17c8148a891e4">XAxiDma_BdHwCompleted(XAxiDma_Bd* BdPtr)</a>;</li>
<li>int <a class="el" href="xaxidma__bd_8h.html#aae88a4ef129d6100fd087f7693186d80">XAxiDma_BdGetActualLength(XAxiDma_Bd* BdPtr)</a>;</li>
<li>int <a class="el" href="xaxidma__bd_8h.html#afc6434a23594c20c2b601f010a979e48">XAxiDma_BdSetAppWord(XAxiDma_Bd * BdPtr, int Offset, u32 Word)</a>;</li>
<li>u32 <a class="el" href="xaxidma__bd_8h.html#a9d2814e4249884e68fe9e6f370920ca4">XAxiDma_BdGetAppWord(XAxiDma_Bd * BdPtr, int Offset, int *Valid)</a>;</li>
</ul>
<p><b>API Functions That Have Been Removed</b></p>
<p>Please see individual function comments for how to replace the removed API function with new API functions.</p>
<ul>
<li>void XLlDma_Initialize(XLlDma * InstancePtr, u32 BaseAddress). This function is replaced by <a class="el" href="xaxidma_8h.html#acd79fe1f2642f5cf8423e483b6f54e6e">XAxiDma_LookupConfig()</a>/XAxiDma_CfgInitialize()</li>
</ul>
<ul>
<li>u32 XLlDma_BdRingGetCr(XLlDma_BdRing* RingPtr). This is replaced by <a class="el" href="xaxidma__bdring_8h.html#a24cd47cdbfac0813e0d9caf966a1a3d2">XAxiDma_BdRingGetError(XAxiDma_BdRing* RingPtr)</a></li>
</ul>
<ul>
<li>u32 XLlDma_BdRingSetCr(XLlDma_BdRing* RingPtr, u32 Data). This function is covered by other API functions:<ul>
<li>void <a class="el" href="xaxidma__bdring_8h.html#a2518030938ab80081f6896fc5589682c">XAxiDma_BdRingIntEnable(XAxiDma_BdRing* RingPtr, u32 Mask)</a></li>
<li>void <a class="el" href="xaxidma__bdring_8h.html#a0269e07693c731cf7721c6f19f8eb69b">XAxiDma_BdRingIntDisable(XAxiDma_BdRing* RingPtr, u32 Mask)</a></li>
<li>int XAxiDma_BdRingSetCoalesce(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, u32 Counter, u32 Timer)</li>
</ul>
</li>
</ul>
<ul>
<li>u32 XLlDma_BdSetStsCtrl(XLlDma_Bd* BdPtr, u32 Data). Replaced by <a class="el" href="xaxidma__bd_8h.html#a4eb2615ac89054e982c3f3c37f0ddb52">XAxiDma_BdSetCtrl(XAxiDma_Bd *BdPtr, u32 Data)</a>;</li>
</ul>
<ul>
<li>u32 XLlDma_BdGetStsCtrl(XLlDma_Bd* BdPtr). Replaced by <a class="el" href="xaxidma__bd_8h.html#a495e780d704ecf548d3536b3bb8961a5">XAxiDma_BdGetCtrl(XAxiDma_Bd* BdPtr)</a> and <a class="el" href="xaxidma__bd_8h.html#a8a0271e5255b139cc63e08e46b9c473a">XAxiDma_BdGetSts(XAxiDma_Bd* BdPtr)</a>.</li>
</ul>
<p><b>API Functions That Have Been Added to support simple DMA mode</b></p>
<ul>
<li>u32 <a class="el" href="xaxidma_8h.html#aff68c0ba3e9e25dfe5e39153301862f8">XAxiDma_Busy(XAxiDma *InstancePtr,int Direction)</a>;</li>
<li>int XAxiDma_SimpleTransfer(<a class="el" href="struct_x_axi_dma.html">XAxiDma</a> *InstancePtr, u32 BuffAddr, int Length, int Direction);</li>
<li><a class="el" href="xaxidma_8h.html#a18dd03026dd6c0ebd13526116c09ccae">XAxiDma_HasSg(InstancePtr)</a>;</li>
<li><a class="el" href="xaxidma_8h.html#adac28afa26e2cb55bdada1ee3c016c52">XAxiDma_IntrEnable(InstancePtr,Mask,Direction)</a>;</li>
<li><a class="el" href="xaxidma_8h.html#adba63ad7c0a784d569736a8d1eb7c367">XAxiDma_IntrGetEnabled(InstancePtr, Direction)</a>;</li>
<li><a class="el" href="xaxidma_8h.html#a1936b497c0fa61d326807e5ed8dd572b">XAxiDma_IntrDisable(InstancePtr, Mask, Direction)</a>;</li>
<li><a class="el" href="xaxidma_8h.html#a6a0eb17bcfcaf3331e01855d302f5f0e">XAxiDma_IntrGetIrq(InstancePtr, Direction)</a>;</li>
<li><a class="el" href="xaxidma_8h.html#a9ff0d2e5b50846e4b6a2d683283c10d5">XAxiDma_IntrAckIrq(InstancePtr, Mask, Direction)</a>;</li>
</ul>
<p><b> For xaxidma driver v6_00_a Multiple Channel Support --------------------------------------------------- This driver supports Multi-channel mode and accordingly some APIs are changed to index multiple channels. Few new APIs are added.</p>
<ul>
<li>Changed APIs * <a class="el" href="xaxidma_8h.html#a6373ac3baa5365607f6727f4e2ece7a5">XAxiDma_GetRxRing(InstancePtr, RingIndex)</a> * XAxiDma_Start(XAxiDma * InstancePtr, int RingIndex) * XAxiDma_Started(XAxiDma * InstancePtr, int RingIndex) * XAxiDma_Pause(XAxiDma * InstancePtr, int RingIndex) * XAxiDma_Resume(XAxiDma * InstancePtr, int RingIndex) * XAxiDma_SimpleTransfer(<a class="el" href="struct_x_axi_dma.html">XAxiDma</a> *InstancePtr, u32 BuffAddr, u32 Length, int Direction, int RingIndex) * XAxiDma_StartBdRingHw(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * XAxiDma_BdRingStart(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * XAxiDma_BdRingToHw(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int NumBd, XAxiDma_Bd * BdSetPtr, int RingIndex) * XAxiDma_BdRingDumpRegs(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * XAxiDma_BdRingSnapShotCurrBd(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * XAxiDma_BdSetLength(XAxiDma_Bd *BdPtr, u32 LenBytes, u32 LengthMask) * <a class="el" href="xaxidma__bd_8h.html#aae88a4ef129d6100fd087f7693186d80">XAxiDma_BdGetActualLength(BdPtr, LengthMask)</a> * <a class="el" href="xaxidma__bd_8h.html#adaf226acada2c1d857d29205ce4c2a58">XAxiDma_BdGetLength(BdPtr, LengthMask)</a></li>
</ul>
<p></b></p>
<p><b></p>
<ul>
<li>New APIs * XAxiDma_SelectKeyHole(<a class="el" href="struct_x_axi_dma.html">XAxiDma</a> *InstancePtr, int Direction, int Select) * XAxiDma_UpdateBdRingCDesc(<a class="el" href="struct_x_axi_dma___bd_ring.html">XAxiDma_BdRing</a> * RingPtr, int RingIndex) * <a class="el" href="xaxidma__bd_8h.html#aa5bc321894b77ca6194c867018d9fe12">XAxiDma_BdSetTId()</a> * <a class="el" href="xaxidma__bd_8h.html#ac14fa76311fd7e5fb59b81fd9e251f62">XAxiDma_BdGetTId()</a> * <a class="el" href="xaxidma__bd_8h.html#a5f9b3088c4e16c7f5584610a43b17462">XAxiDma_BdSetTDest()</a> * <a class="el" href="xaxidma__bd_8h.html#a8c1e3dd04821568424ffc77caf11a851">XAxiDma_BdGetTDest()</a> * <a class="el" href="xaxidma__bd_8h.html#acf41c0ebe00870b6cdd34e46698e081b">XAxiDma_BdSetTUser()</a> * <a class="el" href="xaxidma__bd_8h.html#a7a2f9668058b7e4cdc89dffcce6086d3">XAxiDma_BdGetTUser()</a> * <a class="el" href="xaxidma__bd_8h.html#ac7d8a383cd6d5aff6ee36c3a3db20cbf">XAxiDma_BdSetARCache()</a> * <a class="el" href="xaxidma__bd_8h.html#aa5f7ba67cbbb678662e4b5d36c63d16e">XAxiDma_BdGetARCache()</a> * <a class="el" href="xaxidma__bd_8h.html#ae89253197f1aef6582d5cda3e49f8ead">XAxiDma_BdSetARUser()</a> * <a class="el" href="xaxidma__bd_8h.html#a72d1616af8d996f12db78473a75b54b6">XAxiDma_BdGetARUser()</a> * <a class="el" href="xaxidma__bd_8h.html#a58961be41e3c0bc2694444bfe37b6c27">XAxiDma_BdSetStride()</a> * <a class="el" href="xaxidma__bd_8h.html#a29a75b8f1de16a347544e37b48d8129c">XAxiDma_BdGetStride()</a> * <a class="el" href="xaxidma__bd_8h.html#a383b2c0667bf5bafa22922168895bd5e">XAxiDma_BdSetVSize()</a> * <a class="el" href="xaxidma__bd_8h.html#ad9f48ceb5b30d66bab23337edc35d2fe">XAxiDma_BdGetVSize()</a> <b> For xaxidma driver v7_00_a ---------------------------------------------------</b></li>
<li><b>New API * <a class="el" href="xaxidma_8h.html#af03e87b58cf2f9800e6260fda3745631">XAxiDma_GetRxIndexRing(InstancePtr, RingIndex)</a></b></li>
</ul>
<p></b></p>
<p><b><b></p>
<ul>
<li>Changed APIs All the APIs changed in v6_00_a are reverted back for backward compatibility.  </li>
</ul>
<p></b></b></p>
</div>
<p class="Copyright">
Copyright &copy; 1995-2014 Xilinx, Inc. All rights reserved.
</p>
</body>
</html>
