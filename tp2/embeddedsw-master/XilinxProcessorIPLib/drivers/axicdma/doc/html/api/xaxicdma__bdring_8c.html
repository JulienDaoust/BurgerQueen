<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   Xilinx Driver can v3_0: xaxicdma_bdring.c File Reference
</title>
<link href="doxygen_kalyanidocs/doc/css/driver_api_doxygen.css" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">

<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>xaxicdma_bdring.c File Reference</h1><code>#include &quot;<a class="el" href="xaxicdma_8h.html">xaxicdma.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="xaxicdma__i_8h.html">xaxicdma_i.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a8b27999c6bc00de70e631d559e730074">XAXICDMA_RING_SEEKAHEAD</a>(InstancePtr, BdPtr, NumBd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a51a73e9c6757c7b3aca56d452abda2e8">XAXICDMA_RING_SEEKBACK</a>(InstancePtr, BdPtr, NumBd)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a053a709df2ef12a0c5e6144d824548b4">XAxiCdma_BdRingCntCalc</a> (u32 Alignment, u32 Bytes, u32 BdBuffAddr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a1fdf9f83484b6869cc37249028def78a">XAxiCdma_BdRingMemCalc</a> (u32 Alignment, int NumBd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a77af17739c5b58ca5440176355324022">XAxiCdma_BdRingGetCnt</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#abce64a96cfb86fe370be64ad3dda7e88">XAxiCdma_BdRingGetFreeCnt</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a4677cddba8354ca3979f9b6ae386ffde">XAxiCdma_BdRingSnapShotCurrBd</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a44b28bc8523d7770157b12d4f996d249">XAxiCdma_BdRingGetCurrBd</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#aef6cca02b3180f9a4d977dc1d9e8e1ae">XAxiCdma_BdRingNext</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, <a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *BdPtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a95b6d2f63ea3b0ccefc4eb155070b719">XAxiCdma_BdRingPrev</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, <a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *BdPtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a8c4e66e92f9739dd9de28d156e028c6b">XAxiCdma_BdRingCreate</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, u32 PhysAddr, u32 VirtAddr, u32 Alignment, int BdCount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a39cf1df118ea142a91e35fb41d421929">XAxiCdma_BdRingClone</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, <a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *TemplateBdPtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a4b168a008bd2ea4a7797d60a716e29f6">XAxiCdma_BdRingAlloc</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, int NumBd, <a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> **BdSetPtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#afa7e792362f65151e2f854731f3002c1">XAxiCdma_BdRingUnAlloc</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, int NumBd, <a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *BdSetPtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#ae453b4262bd244ec19abd59832a87e86">XAxiCdma_BdRingToHw</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, int NumBd, <a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *BdSetPtr, <a class="el" href="xaxicdma_8h.html#a190041f3a52f247fbc91a93041095aac">XAxiCdma_CallBackFn</a> CallBackFn, void *CallBackRef)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#ae94bad12ae7b26d63871a6ed5e8593c6">XAxiCdma_BdRingFromHw</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, int BdLimit, <a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> **BdSetPtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a2447d02b1d2c12ec812746b452ff53cc">XAxiCdma_BdRingFree</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr, int NumBd, <a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *BdSetPtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xaxicdma__bdring_8c.html#a846b6992b84583d1692bf742e15e04fb">XAxiCdma_BdRingStartTransfer</a> (<a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *InstancePtr)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Implementation for support on Scatter Gather (SG) transfers. It includes the implementation of the BD ring API. There is only one BD ring per DMA engine.</p>
<pre>
 MODIFICATION HISTORY:</pre><pre> Ver   Who  Date     Changes
 ----- ---- -------- -------------------------------------------------------
 1.00a jz   04/18/10 First release
 2.01a rkv  01/25/11 Replaced with "\r\n" in place on "\n\r" in printf statements
 </pre> <hr/><h2>Define Documentation</h2>
<a class="anchor" id="a8b27999c6bc00de70e631d559e730074"></a><!-- doxytag: member="xaxicdma_bdring.c::XAXICDMA_RING_SEEKAHEAD" ref="a8b27999c6bc00de70e631d559e730074" args="(InstancePtr, BdPtr, NumBd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XAXICDMA_RING_SEEKAHEAD</td>
          <td>(</td>
          <td class="paramtype">InstancePtr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BdPtr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NumBd&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{                                                                  \
    u32 Addr = (u32)(BdPtr);                                       \
                                                                   \
    Addr += ((InstancePtr)-&gt;BdSeparation * (NumBd));               \
    <span class="keywordflow">if</span> (Addr &gt; (InstancePtr)-&gt;LastBdAddr) {                        \
        Addr -= (InstancePtr)-&gt;BdRingTotalLen;                     \
    }                                                              \
                                                                   \
    (BdPtr) = (<a class="code" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a>*)Addr;                                  \
}
</pre></div>
</div>
</div>
<a class="anchor" id="a51a73e9c6757c7b3aca56d452abda2e8"></a><!-- doxytag: member="xaxicdma_bdring.c::XAXICDMA_RING_SEEKBACK" ref="a51a73e9c6757c7b3aca56d452abda2e8" args="(InstancePtr, BdPtr, NumBd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XAXICDMA_RING_SEEKBACK</td>
          <td>(</td>
          <td class="paramtype">InstancePtr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BdPtr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NumBd&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{                                                                \
    u32 Addr = (u32)(BdPtr);                                     \
                                                                 \
    Addr -= ((InstancePtr)-&gt;BdSeparation * (NumBd));             \
    <span class="keywordflow">if</span> (Addr &lt; (InstancePtr)-&gt;FirstBdAddr) {                     \
        Addr += (InstancePtr)-&gt;BdRingTotalLen;                   \
    }                                                            \
                                                                 \
    (BdPtr) = (<a class="code" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a>*)Addr;                                \
}
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a4b168a008bd2ea4a7797d60a716e29f6"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingAlloc" ref="a4b168a008bd2ea4a7797d60a716e29f6" args="(XAxiCdma *InstancePtr, int NumBd, XAxiCdma_Bd **BdSetPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingAlloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>NumBd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> **&nbsp;</td>
          <td class="paramname"> <em>BdSetPtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function requests number of BDs from the BD ring.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the pointer to the set of BDs returned</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li>
<li>XST_INVALID_PARAM if requests non-positive number of BDs</li>
<li>XST_FAILURE if not enough free BDs available</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a39cf1df118ea142a91e35fb41d421929"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingClone" ref="a39cf1df118ea142a91e35fb41d421929" args="(XAxiCdma *InstancePtr, XAxiCdma_Bd *TemplateBdPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingClone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>TemplateBdPtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function clones all BDs in the BD ring to be the same as the given BD.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>TemplateBdPtr</em>&nbsp;</td><td>is the BD to be copied from</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li>
<li>XST_DMA_SG_NO_LIST if there is no BD ring</li>
<li>XST_DEVICE_IS_STARTED if the hardware is running</li>
<li>XST_DMA_SG_LIST_ERROR is the BD ring is still in use</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a053a709df2ef12a0c5e6144d824548b4"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingCntCalc" ref="a053a709df2ef12a0c5e6144d824548b4" args="(u32 Alignment, u32 Bytes, u32 BdBuffAddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingCntCalc </td>
          <td>(</td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>Bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>BdBuffAddr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function calculates how many BDs can be built using given number of bytes of memory, according to alignment provided.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Alignment</em>&nbsp;</td><td>is the preferred alignment for the BDs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Bytes</em>&nbsp;</td><td>is the number of bytes of memory to build BDs with </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdBuffAddr</em>&nbsp;</td><td>is the buffer address allocated for the BDs. This is to check the alignment of the buffer to make sure the the buffer is aligned to the BD alignment. An invalid buffer address results in 0.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of BDs can be built. 0 means buffer address is not valid.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>The application is responsible to align the buffer before pass it to this function. </dd></dl>

</div>
</div>
<a class="anchor" id="a8c4e66e92f9739dd9de28d156e028c6b"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingCreate" ref="a8c4e66e92f9739dd9de28d156e028c6b" args="(XAxiCdma *InstancePtr, u32 PhysAddr, u32 VirtAddr, u32 Alignment, int BdCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingCreate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>PhysAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>VirtAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>BdCount</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function creates the BD ring for the driver instance. If a BD ring pre-exist of this ring, the previous ring is lost.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>PhysAddr</em>&nbsp;</td><td>is the physical address of the memory for the BD ring </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>VirtAddr</em>&nbsp;</td><td>is the virtual address of the memory for the BD ring </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Alignment</em>&nbsp;</td><td>is the alignment for the BDs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdCount</em>&nbsp;</td><td>is the number of BDs to create in the ring</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li>
<li>XST_INVALID_PARAM for invalid parameter</li>
<li>XST_DMA_SG_LIST_ERROR for invalid memory region</li>
<li>XST_FAILURE if the hardware build is simple mode only</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>For a system that has flat memory layout, then the PhysAddr and the VirtAddr are the same. </dd></dl>

</div>
</div>
<a class="anchor" id="a2447d02b1d2c12ec812746b452ff53cc"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingFree" ref="a2447d02b1d2c12ec812746b452ff53cc" args="(XAxiCdma *InstancePtr, int NumBd, XAxiCdma_Bd *BdSetPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>NumBd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdSetPtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function returns the BDs back to the free pool of the BD ring.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to free </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the set of BDs to be freed</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li>
<li>XST_INVALID_PARAM if number of BDs is negative</li>
<li>XST_DMA_SG_LIST_ERROR if the BD ring management has a problem</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="ae94bad12ae7b26d63871a6ed5e8593c6"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingFromHw" ref="ae94bad12ae7b26d63871a6ed5e8593c6" args="(XAxiCdma *InstancePtr, int BdLimit, XAxiCdma_Bd **BdSetPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingFromHw </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>BdLimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> **&nbsp;</td>
          <td class="paramname"> <em>BdSetPtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function tries to retrieve completed BDs from the hardware.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdLimit</em>&nbsp;</td><td>is the maximum number of completed BDs to retrieve </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the set of completed BDs</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of completed BDs.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a77af17739c5b58ca5440176355324022"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingGetCnt" ref="a77af17739c5b58ca5440176355324022" args="(XAxiCdma *InstancePtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingGetCnt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function gets the total number of BDs in the BD ring.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The total number of BDs for this instance</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a44b28bc8523d7770157b12d4f996d249"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingGetCurrBd" ref="a44b28bc8523d7770157b12d4f996d249" args="(XAxiCdma *InstancePtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a>* XAxiCdma_BdRingGetCurrBd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function grabs a copy of the current BD pointer from the hardware.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The BD pointer in CDESC register</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="abce64a96cfb86fe370be64ad3dda7e88"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingGetFreeCnt" ref="abce64a96cfb86fe370be64ad3dda7e88" args="(XAxiCdma *InstancePtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingGetFreeCnt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function gets the number of free BDs.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The total number of free BDs for this instance</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a1fdf9f83484b6869cc37249028def78a"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingMemCalc" ref="a1fdf9f83484b6869cc37249028def78a" args="(u32 Alignment, int NumBd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingMemCalc </td>
          <td>(</td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>Alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>NumBd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function calculates how much memory is needed to build requested number of BDs.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Alignment</em>&nbsp;</td><td>is the preferred alignment for the BDs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to be built</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of memory needed to build the BDs</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="aef6cca02b3180f9a4d977dc1d9e8e1ae"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingNext" ref="aef6cca02b3180f9a4d977dc1d9e8e1ae" args="(XAxiCdma *InstancePtr, XAxiCdma_Bd *BdPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a>* XAxiCdma_BdRingNext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function gets the next BD of the current BD on the BD ring.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the current BD</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The next BD on the ring from the current BD, NULL if passed in BdPtr not valid.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a95b6d2f63ea3b0ccefc4eb155070b719"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingPrev" ref="a95b6d2f63ea3b0ccefc4eb155070b719" args="(XAxiCdma *InstancePtr, XAxiCdma_Bd *BdPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a>* XAxiCdma_BdRingPrev </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdPtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function gets the previous BD of the current BD on the BD ring.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdPtr</em>&nbsp;</td><td>is the current BD</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The previous BD on the ring from the current BD</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a4677cddba8354ca3979f9b6ae386ffde"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingSnapShotCurrBd" ref="a4677cddba8354ca3979f9b6ae386ffde" args="(XAxiCdma *InstancePtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XAxiCdma_BdRingSnapShotCurrBd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function grabs a copy of the current BD pointer from the hardware. It is normally used to prepare for the hardware reset. The snapshot of the current BD pointer should be reloaded once the reset is done.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a846b6992b84583d1692bf742e15e04fb"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingStartTransfer" ref="a846b6992b84583d1692bf742e15e04fb" args="(XAxiCdma *InstancePtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingStartTransfer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae453b4262bd244ec19abd59832a87e86"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingToHw" ref="ae453b4262bd244ec19abd59832a87e86" args="(XAxiCdma *InstancePtr, int NumBd, XAxiCdma_Bd *BdSetPtr, XAxiCdma_CallBackFn CallBackFn, void *CallBackRef)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingToHw </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>NumBd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdSetPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma_8h.html#a190041f3a52f247fbc91a93041095aac">XAxiCdma_CallBackFn</a>&nbsp;</td>
          <td class="paramname"> <em>CallBackFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>CallBackRef</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function tries to enqueue the number of BDs to the hardware.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to enqueue </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the set of BDs to be enqueued </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CallBackFn</em>&nbsp;</td><td>is the callback function for this transfer, NULL is fine </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CallBackRef</em>&nbsp;</td><td>is the callback reference pointer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li>
<li>XST_INVALID_PARAM if enqueues negative number of BDs or zero transfer len</li>
<li>XST_DMA_SG_LIST_ERROR if BD ring management has a problem</li>
<li>XST_FIFO_NO_ROOM if the interrupt handler array is full</li>
<li>XST_FAILURE for: Hardware is in invalid state, for example, reset failed Or, the hardware build is simple mode only</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="afa7e792362f65151e2f854731f3002c1"></a><!-- doxytag: member="xaxicdma_bdring.c::XAxiCdma_BdRingUnAlloc" ref="afa7e792362f65151e2f854731f3002c1" args="(XAxiCdma *InstancePtr, int NumBd, XAxiCdma_Bd *BdSetPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XAxiCdma_BdRingUnAlloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_axi_cdma.html">XAxiCdma</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>NumBd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="xaxicdma__bd_8h.html#a4e138c5e58429588fc171c17bc53e966">XAxiCdma_Bd</a> *&nbsp;</td>
          <td class="paramname"> <em>BdSetPtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function tries to free the number of BDs back to the ring.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is the driver instance we are working on </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NumBd</em>&nbsp;</td><td>is the number of BDs to return </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BdSetPtr</em>&nbsp;</td><td>is the set of BDs to be returned</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS for success</li>
<li>XST_INVALID_PARAM if to free non-positive number of BDs</li>
<li>XST_FAILURE if BD ring management shows an error</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
</div>
<p class="Copyright">
Copyright &copy; 1995-2014 Xilinx, Inc. All rights reserved.
</p>
</body>
</html>
