<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   Xilinx Driver usb v5_0: xusb_endpoint.c File Reference
</title>
<link href="doxygen_kalyanidocs/doc/css/driver_api_doxygen.css" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">

<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>xusb_endpoint.c File Reference</h1><code>#include &quot;<a class="el" href="xusb_8h.html">xusb.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xusb__endpoint_8c.html#adc3661c9581f9dea4b01873cbaff31a8">XUsb_EpEnable</a> (const <a class="el" href="struct_x_usb.html">XUsb</a> *InstancePtr, u8 EpNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xusb__endpoint_8c.html#a82e240bb1af0cc302cd2c8b7363161d8">XUsb_EpDisable</a> (const <a class="el" href="struct_x_usb.html">XUsb</a> *InstancePtr, u8 EpNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xusb__endpoint_8c.html#ab38009aad2e0011e0bd392f064edeec7">XUsb_EpStall</a> (const <a class="el" href="struct_x_usb.html">XUsb</a> *InstancePtr, u8 EpNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xusb__endpoint_8c.html#a30a3f5338e5938d9efc1e843c38e9d78">XUsb_EpUnstall</a> (const <a class="el" href="struct_x_usb.html">XUsb</a> *InstancePtr, u8 EpNum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xusb__endpoint_8c.html#a265f540fba1a12b0e310052d4cfa5a2d">XUsb_EpConfigure</a> (<a class="el" href="struct_x_usb.html">XUsb</a> *InstancePtr, u8 EpNum, <a class="el" href="struct_x_usb___ep_config.html">XUsb_EpConfig</a> *EpCfgPtr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xusb__endpoint_8c.html#abf09f948bc604c279cb0a12bba14057b">XUsb_EpDataSend</a> (<a class="el" href="struct_x_usb.html">XUsb</a> *InstancePtr, u8 EpNum, u8 *BufferPtr, u32 BufferLen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xusb__endpoint_8c.html#a143b99da38f8de7e4d0f5cee108fc797">XUsb_EpDataRecv</a> (<a class="el" href="struct_x_usb.html">XUsb</a> *InstancePtr, u8 EpNum, u8 *BufferPtr, u32 BufferLen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xusb__endpoint_8c.html#a8af69babadc9c361e05afca4e350b918">XUsb_EpIsoTransferConfigure</a> (<a class="el" href="struct_x_usb.html">XUsb</a> *InstancePtr, u8 EpNum, u8 NoOfTransfers)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This file contains the USB end point related function definitions.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>None.</dd></dl>
<pre>
 MODIFICATION HISTORY:</pre><pre> Ver   Who  Date     Changes
 ----- ---- ------------------------------------------------------------------
 1.00a hvm  2/22/07 First release
 1.01a hvm  10/2/08 In function XUsb_EpDataRecv, the initialization of
			Buffer0Ready, Buffer1Ready and CurBufNum variables is
			moved before the buffer ready bit is set in the buffer
			ready register.
			Added the initialization of Buffer0Ready, Buffer1Ready
			and CurBufNum variables in the XUsb_EpDataSend function.
 2.00a hvm  12/2/08 Updated the XUsb_EpDataSend and XUsb_EpRecv  functions to
			provide support for DMA and non DMA modes of data
			transfer.
 3.00a hvm  11/18/09 Updated to use HAL processor APIs. Removed _m from the
			name of the macros.</pre><pre> 3.02a hvm  8/5/10  Updated the XUsb_EpDataRecv function to ensure that the
			buffer ready bit setup is now made only during non-DMA
			case. CR570776.</pre><pre> 4.01a hvm  8/23/11 Added an API to set the number of isochronous transfers in
			a microframe for a given endpoint.
 </pre> <hr/><h2>Function Documentation</h2>
<a class="anchor" id="a265f540fba1a12b0e310052d4cfa5a2d"></a><!-- doxytag: member="xusb_endpoint.c::XUsb_EpConfigure" ref="a265f540fba1a12b0e310052d4cfa5a2d" args="(XUsb *InstancePtr, u8 EpNum, XUsb_EpConfig *EpCfgPtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XUsb_EpConfigure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_usb.html">XUsb</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>EpNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_x_usb___ep_config.html">XUsb_EpConfig</a> *&nbsp;</td>
          <td class="paramname"> <em>EpCfgPtr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function configures a specific end point with the given configuration data.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_usb.html">XUsb</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpNum</em>&nbsp;</td><td>is the endpoint number which has to be configured. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpCfgPtr</em>&nbsp;</td><td>is a pointer to the endpoint configuration structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a143b99da38f8de7e4d0f5cee108fc797"></a><!-- doxytag: member="xusb_endpoint.c::XUsb_EpDataRecv" ref="a143b99da38f8de7e4d0f5cee108fc797" args="(XUsb *InstancePtr, u8 EpNum, u8 *BufferPtr, u32 BufferLen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XUsb_EpDataRecv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_usb.html">XUsb</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>EpNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&nbsp;</td>
          <td class="paramname"> <em>BufferPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>BufferLen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function copies the received data from end point buffer to the buffer passed and then makes the device ready for receiving data again into the same end point buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_usb.html">XUsb</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpNum</em>&nbsp;</td><td>is the endpoint number. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BufferPtr</em>&nbsp;</td><td>is a pointer to buffer where data is to be copied. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BufferLen</em>&nbsp;</td><td>is the number of data bytes to be received.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if successful.</li>
<li>XST_FAILURE if there is no received data in any of the ping pong buffers.</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None </dd></dl>

</div>
</div>
<a class="anchor" id="abf09f948bc604c279cb0a12bba14057b"></a><!-- doxytag: member="xusb_endpoint.c::XUsb_EpDataSend" ref="abf09f948bc604c279cb0a12bba14057b" args="(XUsb *InstancePtr, u8 EpNum, u8 *BufferPtr, u32 BufferLen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XUsb_EpDataSend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_usb.html">XUsb</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>EpNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&nbsp;</td>
          <td class="paramname"> <em>BufferPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&nbsp;</td>
          <td class="paramname"> <em>BufferLen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function copies the transmit data to the end point buffer and enables the buffer for transmission.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_usb.html">XUsb</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpNum</em>&nbsp;</td><td>is the endpoint number. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BufferPtr</em>&nbsp;</td><td>is a pointer to buffer containing the data to be sent. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BufferLen</em>&nbsp;</td><td>is the number of data bytes to be sent.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if successful.</li>
<li>XST_FAILURE if the send operation could not be performed due to non availability of the ping pong buffers in the DPRAM.</li>
</ul>
</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Success doesn't imply that the data is actually transmitted, it only confirms that the DPRAM buffer is updated with send data and the core is enabled for transmitting the data. </dd></dl>

</div>
</div>
<a class="anchor" id="a82e240bb1af0cc302cd2c8b7363161d8"></a><!-- doxytag: member="xusb_endpoint.c::XUsb_EpDisable" ref="a82e240bb1af0cc302cd2c8b7363161d8" args="(const XUsb *InstancePtr, u8 EpNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XUsb_EpDisable </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_x_usb.html">XUsb</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>EpNum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function disables the specified endpoint for all operations.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_usb.html">XUsb</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpNum</em>&nbsp;</td><td>is the endpoint number which has to be disabled for operations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="adc3661c9581f9dea4b01873cbaff31a8"></a><!-- doxytag: member="xusb_endpoint.c::XUsb_EpEnable" ref="adc3661c9581f9dea4b01873cbaff31a8" args="(const XUsb *InstancePtr, u8 EpNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XUsb_EpEnable </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_x_usb.html">XUsb</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>EpNum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function enables the specified endpoint for all operations.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_usb.html">XUsb</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpNum</em>&nbsp;</td><td>is the endpoint number which has to be enabled for operations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
<a class="anchor" id="a8af69babadc9c361e05afca4e350b918"></a><!-- doxytag: member="xusb_endpoint.c::XUsb_EpIsoTransferConfigure" ref="a8af69babadc9c361e05afca4e350b918" args="(XUsb *InstancePtr, u8 EpNum, u8 NoOfTransfers)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XUsb_EpIsoTransferConfigure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_usb.html">XUsb</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>EpNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>NoOfTransfers</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function sets the number of isochronous transfers in a microframe for a given endpoint.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_usb.html">XUsb</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpNum</em>&nbsp;</td><td>is the endpoint number. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NoOfTransfers</em>&nbsp;</td><td>is the number of transfers in a microframe.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>The values allowed for number of transfers is 1, 2 and 3. This function should be called after all the endpoints are configured. The allowed value for EpNum is 1 to 7 </dd></dl>

</div>
</div>
<a class="anchor" id="ab38009aad2e0011e0bd392f064edeec7"></a><!-- doxytag: member="xusb_endpoint.c::XUsb_EpStall" ref="ab38009aad2e0011e0bd392f064edeec7" args="(const XUsb *InstancePtr, u8 EpNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XUsb_EpStall </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_x_usb.html">XUsb</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>EpNum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function stalls operations for the specified endpoint.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_usb.html">XUsb</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpNum</em>&nbsp;</td><td>is the endpoint number which has to be stalled for operations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function does not guaranty the Stall operation, it only sets the Stall bit in the Endpoint configuration register. </dd></dl>

</div>
</div>
<a class="anchor" id="a30a3f5338e5938d9efc1e843c38e9d78"></a><!-- doxytag: member="xusb_endpoint.c::XUsb_EpUnstall" ref="a30a3f5338e5938d9efc1e843c38e9d78" args="(const XUsb *InstancePtr, u8 EpNum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void XUsb_EpUnstall </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_x_usb.html">XUsb</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>EpNum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function unstalls operations for the specified endpoint.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_usb.html">XUsb</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EpNum</em>&nbsp;</td><td>is the endpoint number for which the unstall operations are to be carried out.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>This function does not guaranty the Stall operation, it only sets the Stall bit in the Endpoint configuration register. </dd></dl>

</div>
</div>
</div>
<p class="Copyright">
Copyright &copy; 1995-2014 Xilinx, Inc. All rights reserved.
</p>
</body>
</html>
