<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   Xilinx Driver bram v4_0: xbram_selftest.c File Reference
</title>
<link href="doxygen_kalyanidocs/doc/css/driver_api_doxygen.css" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">

<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>xbram_selftest.c File Reference</h1><code>#include &quot;<a class="el" href="xbram_8h.html">xbram.h</a>&quot;</code><br/>
<code>#include &quot;xil_cache.h&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xbram__selftest_8c.html#a32f09dc6ffd60fee4ba2e4aef1564505">TOTAL_BITS</a>&nbsp;&nbsp;&nbsp;39</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xbram__selftest_8c.html#afd1e62bd024513206f4ecd3ffcd897a1">RD</a>(reg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xbram__selftest_8c.html#a2e348dff3d88a815a9c77b6dc3d46a23">WR</a>(reg, data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xbram__selftest_8c.html#af9c03aff7e031d71fe89b0c2a0aa173b">CHECK</a>(reg, data, result)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xbram__selftest_8c.html#aedbdefb6cda5c212f03271143ccf7a98">XBram_SelfTest</a> (<a class="el" href="struct_x_bram.html">XBram</a> *InstancePtr, u8 IntMask)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The implementation of the <a class="el" href="struct_x_bram.html">XBram</a> driver's self test function. This SelfTest is only applicable if ECC is enabled. If ECC is not enabled then this function will return XST_SUCCESS. See <a class="el" href="xbram_8h.html">xbram.h</a> for more information about the driver. Temp change</p>
<dl class="note"><dt><b>Note:</b></dt><dd></dd></dl>
<p>None</p>
<pre>
 MODIFICATION HISTORY:</pre><pre> Ver   Who  Date     Changes
 ----- ---- -------- -----------------------------------------------
 1.00a sa   11/24/10 First release
 3.01a sa   01/13/12  Changed Selftest API from
		       XBram_SelfTest(XBram *InstancePtr) to
		       <a class="el" href="xbram__selftest_8c.html#aedbdefb6cda5c212f03271143ccf7a98">XBram_SelfTest(XBram *InstancePtr, u8 IntMask)</a> and
		       fixed a problem with interrupt generation for CR 639274
		       Modified Selftest example to return XST_SUCCESS when
		       ECC is not enabled and return XST_FAILURE when ECC is
		       enabled and Control Base Address is zero (CR 636581)
		       Modified Selftest to use correct CorrectableCounterBits
		       for CR 635655
		       Updated to check CorrectableFailingDataRegs in the case
		       of LMB BRAM.
 3.02a sa  04/16/12   Added test of byte and halfword read-modify-write
 3.03a bss 05/22/13   Added Xil_DCacheFlushRange in InjectErrors API to
		       flush the Cache after writing to BRAM (CR #719011)
 </pre> <hr/><h2>Define Documentation</h2>
<a class="anchor" id="af9c03aff7e031d71fe89b0c2a0aa173b"></a><!-- doxytag: member="xbram_selftest.c::CHECK" ref="af9c03aff7e031d71fe89b0c2a0aa173b" args="(reg, data, result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECK</td>
          <td>(</td>
          <td class="paramtype">reg, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">result&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">if</span> (result!=XST_SUCCESS || <a class="code" href="xbram__selftest_8c.html#afd1e62bd024513206f4ecd3ffcd897a1">RD</a>(reg)!=data) \
                                                result = XST_FAILURE;
</pre></div>
</div>
</div>
<a class="anchor" id="afd1e62bd024513206f4ecd3ffcd897a1"></a><!-- doxytag: member="xbram_selftest.c::RD" ref="afd1e62bd024513206f4ecd3ffcd897a1" args="(reg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RD</td>
          <td>(</td>
          <td class="paramtype">reg&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><a class="code" href="xbram__hw_8h.html#aa1021011d8c25fa885737c6ca9695742">XBram_ReadReg</a>(InstancePtr-&gt;Config.CtrlBaseAddress, \
                                        XBRAM_ ## reg)
</pre></div>
</div>
</div>
<a class="anchor" id="a32f09dc6ffd60fee4ba2e4aef1564505"></a><!-- doxytag: member="xbram_selftest.c::TOTAL_BITS" ref="a32f09dc6ffd60fee4ba2e4aef1564505" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOTAL_BITS&nbsp;&nbsp;&nbsp;39</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2e348dff3d88a815a9c77b6dc3d46a23"></a><!-- doxytag: member="xbram_selftest.c::WR" ref="a2e348dff3d88a815a9c77b6dc3d46a23" args="(reg, data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WR</td>
          <td>(</td>
          <td class="paramtype">reg, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><a class="code" href="xbram__hw_8h.html#a65c3e2f96ab713a71079e4597c3d4b3b">XBram_WriteReg</a>(InstancePtr-&gt;Config.CtrlBaseAddress, \
                                                XBRAM_ ## reg, data)
</pre></div>
</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="aedbdefb6cda5c212f03271143ccf7a98"></a><!-- doxytag: member="xbram_selftest.c::XBram_SelfTest" ref="aedbdefb6cda5c212f03271143ccf7a98" args="(XBram *InstancePtr, u8 IntMask)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int XBram_SelfTest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_x_bram.html">XBram</a> *&nbsp;</td>
          <td class="paramname"> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&nbsp;</td>
          <td class="paramname"> <em>IntMask</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Run a self-test on the driver/device. Unless fault injection is implemented in hardware, this function only does a minimal test in which available registers (if any) are written and read.</p>
<p>With fault injection, all possible single-bit and double-bit errors are injected, and checked to the extent possible, given the implemented hardware.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>is a pointer to the <a class="el" href="struct_x_bram.html">XBram</a> instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>IntMask</em>&nbsp;</td><td>is the interrupt mask to use. When testing with interrupts, this should be set to allow interrupt generation, otherwise it should be 0.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>XST_SUCCESS if fault injection/detection is working properly OR if ECC is Not Enabled in the HW.</li>
<li>XST_FAILURE if the injected fault is not correctly detected or the Control Base Address is Zero when ECC is enabled.</li>
</ul>
If the BRAM device is not present in the hardware a bus error could be generated. Other indicators of a bus error, such as registers in bridges or buses, may be necessary to determine if this function caused a bus error.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None. </dd></dl>

</div>
</div>
</div>
<p class="Copyright">
Copyright &copy; 1995-2014 Xilinx, Inc. All rights reserved.
</p>
</body>
</html>
