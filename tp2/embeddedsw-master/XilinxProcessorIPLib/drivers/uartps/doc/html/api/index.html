<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   Xilinx Driver uartps v2_2: uartps v2_2
</title>
<link href="doxygen_kalyanidocs/doc/css/driver_api_doxygen.css" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">

<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>uartps v2_2</h1><p>This driver supports the following features:</p>
<ul>
<li>Dynamic data format (baud rate, data bits, stop bits, parity)</li>
<li>Polled mode</li>
<li>Interrupt driven mode</li>
<li>Transmit and receive FIFOs (32 byte FIFO depth)</li>
<li>Access to the external modem control lines</li>
</ul>
<p><b>Initialization &amp; Configuration</b></p>
<p>The <a class="el" href="struct_x_uart_ps___config.html">XUartPs_Config</a> structure is used by the driver to configure itself. Fields inside this structure are properties of <a class="el" href="struct_x_uart_ps.html">XUartPs</a> based on its hardware build.</p>
<p>To support multiple runtime loading and initialization strategies employed by various operating systems, the driver instance can be initialized in the following way:</p>
<ul>
<li>XUartPs_CfgInitialize(InstancePtr, CfgPtr, EffectiveAddr) - Uses a configuration structure provided by the caller. If running in a system with address translation, the parameter EffectiveAddr should be the virtual address.</li>
</ul>
<p><b>Baud Rate</b></p>
<p>The UART has an internal baud rate generator, which furnishes the baud rate clock for both the receiver and the transmitter. Ther input clock frequency can be either the master clock or the master clock divided by 8, configured through the mode register.</p>
<p>Accompanied with the baud rate divider register, the baud rate is determined by: </p>
<pre>
	baud_rate = input_clock / (bgen * (bdiv + 1)
 </pre><p> where bgen is the value of the baud rate generator, and bdiv is the value of baud rate divider.</p>
<p><b>Interrupts</b></p>
<p>The FIFOs are not flushed when the driver is initialized, but a function is provided to allow the user to reset the FIFOs if desired.</p>
<p>The driver defaults to no interrupts at initialization such that interrupts must be enabled if desired. An interrupt is generated for one of the following conditions.</p>
<ul>
<li>A change in the modem signals</li>
<li>Data in the receive FIFO for a configuable time without receiver activity</li>
<li>A parity error</li>
<li>A framing error</li>
<li>An overrun error</li>
<li>Transmit FIFO is full</li>
<li>Transmit FIFO is empty</li>
<li>Receive FIFO is full</li>
<li>Receive FIFO is empty</li>
<li>Data in the receive FIFO equal to the receive threshold</li>
</ul>
<p>The application can control which interrupts are enabled using the <a class="el" href="xuartps_8h.html#ab3b65e926f6f4ac7ab41a70801ba12c3">XUartPs_SetInterruptMask()</a> function.</p>
<p>In order to use interrupts, it is necessary for the user to connect the driver interrupt handler, <a class="el" href="xuartps_8h.html#abf86fb20a58e4a7fbd73afa49f8eb604">XUartPs_InterruptHandler()</a>, to the interrupt system of the application. A separate handler should be provided by the application to communicate with the interrupt system, and conduct application specific interrupt handling. An application registers its own handler through the <a class="el" href="xuartps_8h.html#a9528098e589491997c7805592a4b5a7b">XUartPs_SetHandler()</a> function.</p>
<p><b>Data Transfer</b></p>
<p>The functions, <a class="el" href="xuartps_8c.html#adff739cf6e252c42a050e92d3a265172">XUartPs_Send()</a> and <a class="el" href="xuartps_8c.html#a74e1aeb2b28a79a9e17e431280296a60">XUartPs_Recv()</a>, are provided in the driver to allow data to be sent and received. They can be used in either polled or interrupt mode.</p>
<dl class="note"><dt><b>Note:</b></dt><dd></dd></dl>
<p>The default configuration for the UART after initialization is:</p>
<ul>
<li>9,600 bps or XPAR_DFT_BAUDRATE if defined</li>
<li>8 data bits</li>
<li>1 stop bit</li>
<li>no parity</li>
<li>FIFO's are enabled with a receive threshold of 8 bytes</li>
<li>The RX timeout is enabled with a timeout of 1 (4 char times)</li>
</ul>
<pre>
 MODIFICATION HISTORY:</pre><pre> Ver   Who    Date	Changes
 ----- ------ -------- ----------------------------------------------
 1.00a	drg/jz 01/12/10 First Release
 1.00a sdm    09/27/11 Fixed compiler warnings and also a bug
		        in XUartPs_SetFlowDelay where the value was not
			being written to the register.
 1.01a sdm    12/20/11 Removed the InputClockHz parameter from the <a class="el" href="struct_x_uart_ps.html">XUartPs</a>
			instance structure and the driver is updated to use
			InputClockHz parameter from the <a class="el" href="struct_x_uart_ps___config.html">XUartPs_Config</a> config
			structure.
			Added a parameter to <a class="el" href="struct_x_uart_ps___config.html">XUartPs_Config</a> structure which
			specifies whether the user has selected Modem pins
			to be connected to MIO or FMIO.
			Added the tcl file to generate the xparameters.h
 1.02a sg     05/16/12	Changed XUARTPS_RXWM_MASK to 0x3F for CR 652540 fix.
 1.03a sg     07/16/12 Updated XUARTPS_FORMAT_7_BITS and XUARTPS_FORMAT_6_BITS
			with the correct values for CR 666724
 			Added defines for XUARTPS_IXR_TOVR,  XUARTPS_IXR_TNFUL
			and XUARTPS_IXR_TTRIG.
			Modified the name of these defines
			XUARTPS_MEDEMSR_DCDX to XUARTPS_MODEMSR_DDCD
			XUARTPS_MEDEMSR_RIX to XUARTPS_MODEMSR_TERI
			XUARTPS_MEDEMSR_DSRX to XUARTPS_MODEMSR_DDSR
			XUARTPS_MEDEMSR_CTSX to XUARTPS_MODEMSR_DCTS
 1.05a hk     08/22/13 Added API for uart reset and related
			constant definitions.
 2.0   hk      03/07/14 Version number revised.
 2.1   hk     04/16/14 Change XUARTPS_MAX_RATE to 921600. CR# 780625.
 2.2   hk     06/23/14 SW reset of RX and TX should be done when changing
                       baud rate. CR# 804281.</pre><pre> </pre> </div>
<p class="Copyright">
Copyright &copy; 1995-2014 Xilinx, Inc. All rights reserved.
</p>
</body>
</html>
