<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>2014.1_doc: xilskey_epl.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_U_3A_2Fdoxygen_5Fpublish_2Fsources_2Fsw_5Fservices_2Fxilskey_5Fv2_5F0_2Fsrc_2Finclude_2F.html">include</a></div>
<h1>xilskey_epl.h File Reference</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_xil_s_key___e_pl.html">XilSKey_EPl</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xilskey__epl_8h.html#3ec52ea26d1cbdfe8b03851efd3fd648">XSK_EFUSEPL_AES_KEY_SIZE_IN_BYTES</a>&nbsp;&nbsp;&nbsp;(32)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xilskey__epl_8h.html#5a9957c1f1f6e9220de5365d53e6a75e">XSK_EFUSEPL_USER_KEY_SIZE_IN_BYTES</a>&nbsp;&nbsp;&nbsp;(4)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xilskey__epl_8h.html#c8975c632e573c0b5c88f3ad24dc8178">XilSKey_EfusePl_Program</a> (<a class="el" href="struct_xil_s_key___e_pl.html">XilSKey_EPl</a> *PlInstancePtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xilskey__epl_8h.html#e5328f69992f20f9c9207877e8d0e22f">XilSKey_EfusePl_ReadStatus</a> (<a class="el" href="struct_xil_s_key___e_pl.html">XilSKey_EPl</a> *InstancePtr, u32 *StatusBits)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">u32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xilskey__epl_8h.html#d46fc69c2821971cd015f6e1e3b9a0f4">XilSKey_EfusePl_ReadKey</a> (<a class="el" href="struct_xil_s_key___e_pl.html">XilSKey_EPl</a> *InstancePtr)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="xilskey__epl_8h.html">xilskey_epl.h</a> <dl compact><dt><b>Note:</b></dt><dd>Contains the function prototypes, defines and macros for the PL eFUSE functionality.</dd></dl>
MODIFICATION HISTORY:<p>
Ver Who Date Changes ----- ---- -------- -------------------------------------------------------- 1.00a rpoolla 04/26/13 First release 1.02a hk 10/28/13 Added API's to read status bits and key : u32 <a class="el" href="xilskey__epl_8c.html#d46fc69c2821971cd015f6e1e3b9a0f4">XilSKey_EfusePl_ReadKey(XilSKey_EPl *InstancePtr)</a> u32 <a class="el" href="xilskey__epl_8c.html#d46fc69c2821971cd015f6e1e3b9a0f4">XilSKey_EfusePl_ReadKey(XilSKey_EPl *InstancePtr)</a> 2.00 hk 22/01/14 Corrected PL voltage checks to VCCINT and VCCAUX. CR#768077 <hr><h2>Define Documentation</h2>
<a class="anchor" name="3ec52ea26d1cbdfe8b03851efd3fd648"></a><!-- doxytag: member="xilskey_epl.h::XSK_EFUSEPL_AES_KEY_SIZE_IN_BYTES" ref="3ec52ea26d1cbdfe8b03851efd3fd648" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XSK_EFUSEPL_AES_KEY_SIZE_IN_BYTES&nbsp;&nbsp;&nbsp;(32)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
AES Key size in Bytes     </td>
  </tr>
</table>
<a class="anchor" name="5a9957c1f1f6e9220de5365d53e6a75e"></a><!-- doxytag: member="xilskey_epl.h::XSK_EFUSEPL_USER_KEY_SIZE_IN_BYTES" ref="5a9957c1f1f6e9220de5365d53e6a75e" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define XSK_EFUSEPL_USER_KEY_SIZE_IN_BYTES&nbsp;&nbsp;&nbsp;(4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
User Key size in Bytes     </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="c8975c632e573c0b5c88f3ad24dc8178"></a><!-- doxytag: member="xilskey_epl.h::XilSKey_EfusePl_Program" ref="c8975c632e573c0b5c88f3ad24dc8178" args="(XilSKey_EPl *PlInstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">u32 XilSKey_EfusePl_Program           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_xil_s_key___e_pl.html">XilSKey_EPl</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Programs PL eFUSE with input data given<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>- Input data to be written to PL eFUSE</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd></dd></dl>
<ul>
<li>XST_FAILURE - In case of failure</li><li>XST_SUCCESS - In case of Success</li></ul>
<p>
<dl compact><dt><b>Note:</b></dt><dd>Updates the global variable ErrorCode with error code(if any).</dd></dl>
Extract PLL FDIV value from ARM PLL Control Register<p>
Extract Clock divisor value from ARM Clock Control Register<p>
Initialize the variables<p>
Return error if the reference clock frequency is not in between 20 &amp; 60MHz<p>
Initialize the system , which means initialize the timer, xadc, and jtag server using the passed info.<p>
Start using the Jtag server to read the JTAG ID and compare with the stored ID, if it not matches return with unique error code. By reading the Jtag ID we will be sure that the JTAG related stuff is working as expected.<p>
Read the FUSE_CNTL register bits [5:2], and if any of them is found to be set to 1 then we can not write to the eFUSE, so return with unique error.<p>
If everything is well above then start programming with FUSE_AES key as passed to this function, followed by FUSE_USER if selected.<p>
AES key is 256 bits, but has to be written across many rows, in the PL eFUSE each row has 24 bits of data bits and 6 bits of ecc bits. So for 256 bits we will need full 10 rows(240 bits) and extra 1 row for remaining 16 bits, but rest 8 bits will be taken from the FUSE_USER key value[7:0]<p>
check if FUSE_CNTRL allows us to read and write the AES and USER eFUSE array.<p>
convert each aes data bits to bytes.<p>
convert each user data bits to bytes.<p>
check if row 20 to 30 are empty before programming AES and USER low key.<p>
program AES_KEY 256 bits and USER_KEY lower 8 bits first.<p>
prepare row data for row from 20 to 29.<p>
prepare row data for row 30.<p>
check if 31 is empty before programming USER high key.<p>
Program USER_KEY high 24 bits next. Prepare row data for row 31.<p>
If everything is ok then return PASS.     </td>
  </tr>
</table>
<a class="anchor" name="d46fc69c2821971cd015f6e1e3b9a0f4"></a><!-- doxytag: member="xilskey_epl.h::XilSKey_EfusePl_ReadKey" ref="d46fc69c2821971cd015f6e1e3b9a0f4" args="(XilSKey_EPl *InstancePtr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">u32 XilSKey_EfusePl_ReadKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_xil_s_key___e_pl.html">XilSKey_EPl</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>InstancePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reads the PL efuse key (AES and user)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>- Input data to be written to PL eFUSE</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd></dd></dl>
<ul>
<li>XST_FAILURE - In case of failure</li><li>XST_SUCCESS - In case of Success</li></ul>
<p>
<dl compact><dt><b>Note:</b></dt><dd>Updates the global variable ErrorCode with error code(if any).</dd></dl>
Extract PLL FDIV value from ARM PLL Control Register<p>
Extract Clock divisor value from ARM Clock Control Register<p>
Initialize the variables<p>
Return error if the reference clock frequency is not in between 20 &amp; 60MHz<p>
Initialize the timer and jtag server<p>
Monitor the Voltage and temperature using XADC, if out of range return unique error.     </td>
  </tr>
</table>
<a class="anchor" name="e5328f69992f20f9c9207877e8d0e22f"></a><!-- doxytag: member="xilskey_epl.h::XilSKey_EfusePl_ReadStatus" ref="e5328f69992f20f9c9207877e8d0e22f" args="(XilSKey_EPl *InstancePtr, u32 *StatusBits)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">u32 XilSKey_EfusePl_ReadStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="struct_xil_s_key___e_pl.html">XilSKey_EPl</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>InstancePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u32 *&nbsp;</td>
          <td class="mdname" nowrap> <em>StatusBits</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reads the PL efuse status bits<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InstancePtr</em>&nbsp;</td><td>- Input data to be written to PL eFUSE </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>StatusBits</em>&nbsp;</td><td>- Variable to store the status bits read.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd></dd></dl>
<ul>
<li>XST_FAILURE - In case of failure</li><li>XST_SUCCESS - In case of Success</li></ul>
<p>
<dl compact><dt><b>Note:</b></dt><dd>Updates the global variable ErrorCode with error code(if any).</dd></dl>
Extract PLL FDIV value from ARM PLL Control Register<p>
Extract Clock divisor value from ARM Clock Control Register<p>
Initialize the variables<p>
Return error if the reference clock frequency is not in between 20 &amp; 60MHz<p>
Initialize the timer, XADC and jtag server<p>
Monitor the Voltage and temperature using XADC, if out of range return unique error.     </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu Feb 13 14:41:49 2014 for 2014.1_doc by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
